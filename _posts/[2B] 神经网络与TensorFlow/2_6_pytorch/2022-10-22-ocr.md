---
layout: post
title: 【pytorch】OCR
categories:
tags: 0x26_torch
keywords:
description:
order: 262
---

## 理论

分为多个模型
- CTPN 用来检测文字位置
- CRNN 用来检测文字内容

### CTPN

- 通常文本从左到右，
- 且水平，
- 且字之间的宽度大致相同





## easyocr

- https://github.com/JaidedAI/EasyOCR
- 基于 torch 的项目
- 用GPU性能很好，用CPU性能很差

pip install easyocr


```py
import easyocr
reader = easyocr.Reader(['ch_sim','en'],model_storage_directory='./ocr_model')
# , gpu=False  似乎性能差了10倍以上

result = reader.readtext('a.png')

# 省略坐标信息
reader.readtext('b.png', detail = 0)

```

## paddleocr 新


```bash
# pip install paddlepaddle-gpu
pip install paddlepaddle
pip install paddleocr
paddleocr --image_dir ./img/a.png --use_angle_cls true --use_gpu false

```


python
```python
from paddleocr import PaddleOCR

# Paddleocr目前支持的多语言语种可以通过修改lang参数进行切换
# lang = `ch`, `en`, `fr`, `german`, `korean`, `japan` 等等
ocr = PaddleOCR(use_angle_cls=True, lang="ch")
img_path = './a.jpg'
result = ocr.ocr(img_path, cls=True)
for line in result:
    print(line)
```


### 问题

tools.infer 找不到
- 原因：PaddleOCR 的一个子模块叫 tools，但系统已经安装了其它名叫 `tools` 的包，
- 解决（不优雅）：`import imp; imp.find_module('tools')` 找到 tools 安装路径，然后用 `rm -rf tools` 删掉，这样 `PaddleOCR.tools` 就生效了

模型文件
- 默认存在 `~/.paddleocr/`，如果服务器不能连接外网，就复制进去
