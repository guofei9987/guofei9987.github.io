---
layout: post
title: 【Java3】实用代码
categories: 语言
tags:
keywords:
description:
order: 12003
---


```java
System.out.print # 不换行输出


```

```java
Scanner sc = new Scanner(System.in);
int n=sc.nextInt(); // 等待键盘输入
// sc.next() //字符串

System.out.println(n);
```


## 读入文件

```Java
//    用法：List<String> a = readFile("data/a.txt");
//    简化版
    public List<String> readFile(String file) throws IOException {
        List<String> context = new ArrayList<String>();
        BufferedReader bufferedReader = new BufferedReader(new InputStreamReader(new FileInputStream(file)));
        String text;
        while ((text = bufferedReader.readLine()) != null) {
            context.add(text);
        }
        return context;
    }
```



## stream

1. stream不存储数据，而是按照特定的规则对数据进行计算，一般会输出结果。
2. stream不会改变数据源，通常情况下会产生一个新的集合或一个值。
3. stream具有延迟执行特性，只有调用终端操作时，中间操作才会执行。


### 创建

三种方法创建stream
```Java
import java.util.Arrays;
import java.util.List;
import java.util.stream.IntStream;
import java.util.stream.Stream;

// 1、通过 java.util.Collection.stream() 方法用集合创建流
List<String> list = Arrays.asList("a", "b", "c");
// 创建一个顺序流
Stream<String> stream = list.stream();
// 创建一个并行流
Stream<String> parallelStream = list.parallelStream();

// 2、使用java.util.Arrays.stream(T[] array)方法用数组创建流
int[] array={1,3,5,6,8};
IntStream stream = Arrays.stream(array);


// 3、使用Stream的静态方法：of()、iterate()、generate()
Stream<Integer> stream = Stream.of(1, 2, 3, 4, 5, 6);

Stream<Integer> stream2 = Stream.iterate(0, (x) -> x + 3).limit(4);
stream2.forEach(System.out::println); // 0 2 4 6 8 10

Stream<Double> stream3 = Stream.generate(Math::random).limit(3);
stream3.forEach(System.out::println);
```



- stream 是顺序流
- parallelStream 是并行流，如果流中的数据量足够大，并行流可以加快处速度
- stream 可以转 parallelStream：
```Java
Optional<Integer> findFirst = list.stream().parallel().filter(x->x>6).findFirst();
```

### 用法

```Java
import java.util.ArrayList;
import java.util.Arrays;
import java.util.List;
import java.util.Optional;
import java.util.stream.Collectors;

public List<String> strList = Arrays.asList("adnm", "admmt", "pot", "xbangd", "weoujgsd");
public List<Integer> intList = Arrays.asList(7, 6, 9, 3, 8, 2, 1);
```

forEach
```Java
intList.stream().filter(x -> x > 6).forEach(System.out::println);
```

findFirst, findAny
```Java
Optional<Integer> findFirst = intList.stream().filter(x -> x > 6).findFirst();
Optional<Integer> findAny = intList.parallelStream().filter(x -> x > 6).findAny();
findFirst.get()
```

collect
```Java
List<Integer> intList2 = intList.stream().filter(x -> x > 7).collect(Collectors.toList());
// 还可以存为其它类型
Set<Integer> intSet = intList.stream().filter(x -> x > 7).collect(Collectors.toSet());
Map<Integer,Integer> intMap = intList.stream().filter(x -> x > 7).collect(Collectors.toMap(x->x+1, x->x+3));
```



anyMatch
```Java
boolean anyMatch = intList.stream().anyMatch(x -> x < 6);
```

filter（上面有）


聚合（max/min/count)

```Java
// 最长字符串
Optional<String> maxStr = strList.stream().max(Comparator.comparing(String::length));

// 最大整数
Optional<Integer> maxInt = intList.stream().max(Integer::compareTo);
// 自定义排序
Optional<Integer> maxInt2 = intList.stream().max(new Comparator<Integer>() {
    @Override
    public int compare(Integer o1, Integer o2) {
        return o1.compareTo(o2);
    }
});
```






映射(map/flatMap)
```Java
// 大写
strList.stream().map(String::toUpperCase)

// 运算
intList.stream().map(x -> x + 10)
```

flatMap
```Java
// 功能：把字符串切开，平摊成另一个 list
List<String> strListNew = strList.stream().flatMap(s -> {
    String[] split = s.split("");
    Stream<String> s2 = Arrays.stream(split);
    return s2;
}).collect(Collectors.toList());
```




reduce

```Java
// 求和方式1
Optional<Integer> sum = intList.stream().reduce((x, y) -> x + y);
// 求和方式2
Optional<Integer> sum2 = intList.stream().reduce(Integer::sum);
// 求和方式3
Integer sum3 = intList.stream().reduce(0, Integer::sum);

// 求乘积
Optional<Integer> product = intList.stream().reduce((x, y) -> x * y);

// 求最大值方式1
Optional<Integer> max = intList.stream().reduce((x, y) -> x > y ? x : y);
// 求最大值写法2
Integer max2 = intList.stream().reduce(1, Integer::max);
```

聚合函数
```Java
// 求 count
Long cnt = intList.stream().filter(x -> x > 6).collect(Collectors.counting());
// 求平均值
double avg= intList.stream().collect(Collectors.averagingDouble(x->x));
// 求最大值
Optional<Integer> max=intList.stream().collect(Collectors.maxBy(Integer::compare));
// 求和
Integer sum = intList.stream().collect(Collectors.summingInt(x->x));
```

字符串：join
```Java
String strJoined=strList.stream().collect(Collectors.joining("->"));
```

分组
```Java
Map<Boolean,List<Integer>> part=intList.stream().collect(Collectors.partitioningBy(x->x>6));
//>{false=[6, 3, 2, 1], true=[7, 9, 8]}
// 更多用法见原文
```

排序
```Java
List<Integer> intListOrdered=intList.stream().sorted(Comparator.reverseOrder()).collect(Collectors.toList());
// 更多用法见原文
```



合并、去重、限制、跳过等操作
```Java
List<Integer> intList2 = Arrays.asList(9,7, 6, 9, 3, 8, 2, 1);
List<Integer> intListNew=
        Stream.concat(intList.stream(),intList2.stream()). // 合并两个 stream
                distinct().                                 // 去重
                limit(5).                                   // 只取前5个
                skip(2).                                   // 删除其中的 2
                collect(Collectors.toList());              // 输出
```


参考：https://zhuanlan.zhihu.com/p/299064490
