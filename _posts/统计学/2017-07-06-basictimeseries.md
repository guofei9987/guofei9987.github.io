---
layout: post
title: 基本时间序列分析.
categories: 
tags: 统计学
keywords:
description:
---

本文涉及以下内容：  
- 季节调整
- 趋势分解
    - H-P滤波
    - BP滤波
- 指数平滑法


## 季节调整

- 加法模型  
$Y_t=T C_t+S_t+I_t$  
- 乘法模型  
$Y_T=T C_t D_t I_t$  


## 趋势分解

模型背景，研究某些非平稳时间序列时，可以分解成趋势成分和循环成分。  
分类：
- 结构性分解：需要其它经济变量，用变量之间的关系分离出趋势成分和循环成分，如Okun分解，Philllips曲线关系等
- 状态性分解：通过时间序列的性质，分解成趋势成分和循环成分
    - 状态域分解：卡尔曼滤波，差分分解
    - 频域分解：H-P滤波，BP滤波


## 趋势模型

### 常见的模型类型  

罗列一下常见的模型类型  

1. 直线趋势模型  
$\hat Y=a+bt$
2. 二次曲线模型  
$\hat Y=b_0 +b_1 t +b_2 t^2$
3. 三次曲线模型  
$\hat Y=b_0 +b_1 t +b_2 t^2+b_3 t^3$  
4. 幂函数曲线模型  
$\hat Y=a t^b$
5. 对数曲线模型  
$\hat Y= a+b \ln b$
6. 双曲线模型
$\hat Y= a+b \times \dfrac{1}{t}$
7. 指数曲线模型  
$\hat Y=ae^{bt}$
8. 修正指数趋势模型。特点是有增长上限
$\hat Y=L+ae^{bt},a<0,b<0$  
9. 贡伯兹曲线。  
$\hat Y=L e^{-ae^{-bt}},a>0,b>0$  
特点：  
    1. $t \to - \infty \ni Y \to 0$
    2. $t \to \infty \ni Y \to L$
    3. 曲线有拐点，先凹后凸
10. 皮尔曲线模型  
皮尔曲线又叫logistic曲线，较好的描述了生物生长的过程  
$\hat Y= \dfrac{L}{1+ae^{-bt}}$

### 趋势模型的参数估计

《统计预测：方法与模型》给出了两种估计参数的方法：线性最小二乘法，三和值法。scipy给出了一种估计参数的方法：最小二乘估计。

#### 线性最小二乘法

把模型变换成为线性模型，然后用OLS进行估计。  
例如，贡伯兹模型，可以变换成$\ln \ln (L/Y)=\ln a -bt$  

优点：可以使用线性回归的所有检验方法（t检验，F检验...）  
缺点：  
1. 有些模型对应多个线性模型。  
2. 往往残差不是最小。（而是变换后的线性模型残差最小）  


#### 三和值法

把每个间距期分为三段，求每一段的数值和$\sum_1 Y_t,\sum_2Y_t,\sum_3 Y_t$,  
然后用这三段值解出参数

#### 最小二乘估计

用最优化方法求：  
$argmin\sum (y_i-\hat y)^2$  
方法见于另一篇博客[最小二乘估计](http://www.guofei.site/2017/06/06/scipyleastsq.html)  


## 时间序列平滑法

基本思想是：时间序列是某种基本变动和随机误差的叠加。平滑的目的在于消除随机误差。  

分类：  
- 移动平均法
- 指数平滑法

### 移动平均法

#### 简单平均法

用以前所有数的平均值，预测下一个数
$\hat Y_{t+1}= \sum\limits_{i=1}^T Y_i / T $  

#### 简单移动平均法

在简单平均法中，当T比较大时，早期的数据作用已经不大。  
因此用固定的平均期数。    
$\hat Y_{t+1}=\sum\limits_{i=t-T+1}^t Y_i / T $  

等价于：  
$\hat Y_{t+1}=\hat Y_t +\dfrac{1}{T}(Y_t-Y_{t-N})$

#### 加权移动平均法
$$\hat Y{t+1}= \dfrac{\sum\limits_{i=1}^T \alpha_i Y_i}{\sum\limits_{i=1}^T \alpha_i}$$  



## 季节模型

### 季节水平模型

$\hat Y_t=\bar Y f_i$  
其中：  
- $i=1,2,...,12$或$i=1,2,3,4$，表示每个期限中的第i个  
- $\hat Y$是所有期的平均  
- $f_i$是同期所有数的平均/总平均.  
例如，所有的1月份的平均/总平均，就是$f_1$

### 季节交乘趋向模型

$\hat Y=(a+bt)f_i$  
其中，  
- $(a+bt)$是趋势部分  
对参数估计时，可以用经验法。
也可以用OLS法，
- $f_i=\dfrac{Y_i+Y_{i+T}+...+F_{i+(m-1)T}}{m}$  
- m是季节个数。例如，年数。
- T是每个季节的长度。  
例如原始数据为季度数据时，T=4。原始数据为月度数据时，T=12  

$f_i$由公式给出，还需要对趋势部分$(a+bt)$估计：  
可以用经验法。  
也可以用OLS法，估计$V=a+bt$  

### 季节迭加趋势

$\hat Y=(a+bt)+f_i$  

$f_i$的定义同季节交乘趋向模型，$f_i=\dfrac{Y_i+Y_{i+T}+...+F_{i+(m-1)T}}{m}$  

与季节交乘趋向模型的区别似乎是乘法模型和加法模型的区别？这个存疑  
