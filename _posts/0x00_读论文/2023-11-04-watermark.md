---
layout: post
title: 【论文学习】水印类算法
categories:
tags: 0x00_读论文
keywords:
description:
order: 9
---


## 《Practical Deep Dispersed Watermarking with Synchronization and Fusion》

来自字节跳动
- 论文：https://arxiv.org/pdf/2310.14532.pdf
- 代码：https://github.com/bytedance/DWSF


现状：近期基于深度学习的盲水印技术涌现。以往主要集中在固定的低分辨率图像上。对于任意分辨率的图像，尤其是当下广泛使用的高分辨率图像关注较少。大多数工作通常只展示了对典型的非几何攻击（例如，JPEG压缩）的鲁棒性，却忽略了常见的几何攻击（Resize，Rotate，Padding）和更具挑战性的组合攻击（Rotate&JPEG，Resize&Crop）。

本文：对于任意分辨率的封面图像，此论文采用了一种分散的嵌入方案，它稀疏且随机地选择几个固定小尺寸的封面块来通过训练有素的编码器嵌入一致的水印信息。在提取阶段，此论文首先设计了一个水印同步模块来定位并校正受噪声影响的水印图像中的编码块。然后此论文使用解码器来获取这些块中嵌入的信息，并提出了一种基于相似性的信息融合策略来充分利用信息之间的一致性，从而确定可靠的信息。

本文提出了 DWSF（Dispersed Watermarking with Synchronization and Fusion）。
- 嵌入阶段：将水印分散嵌入到封面图像的多个子区域中。从封面图像中稀疏且随机地选择几个小尺寸的封面块，然后通过一个与解码器和抵抗非几何攻击的噪声层共同训练好的编码器，在每个块中嵌入一致的水印信息。与“将水印信息嵌入整个图像的方案”相比，这样的嵌入设计涉及更少的修改，使得水印图像具有更好的视觉质量和较小的文件大小增量。此外，这也可以自然地避免局部擦除攻击（例如，裁剪，遮挡）。
- 在提取阶段，给定一个有水印的图像，此论文设计了一个水印同步模块，该模块旨在定位和校正分散的编码块。具体来说，此论文采用一个分割模型来捕捉不可察觉的甚至是扭曲的水印特征，以预测编码块的区域。如果水印图像被几何攻击（例如，旋转）扭曲，分割结果可以帮助估计几何变换参数（例如，旋转角度），从而逆转几何变换以获得同步的编码块。之后，此论文可以使用解码器来提取每个同步编码块中嵌入的信息。
- 最后，此论文提出了一种基于相似性的信息融合策略，充分利用信息的一致性，可以规避解码信息中可能的偏差对结果的负面影响，从而确定一个更可靠的水印信息。

前人提出的抗几何攻击方案：
- Pereira等人提出将一个额外的模板嵌入到图像中，以估计变换参数，然后逆转这些变换。
- Lin等人通过应用傅立叶-梅林变换在一个几何变换不变的域中嵌入水印信息。
- 然而，这些传统方法往往是为特定的扭曲量身定制的，可能在应用中有很大的局限性。
- 因此，最近的研究转向训练神经网络以实现水印同步。Tancik等人对语义分割模型进行了微调，以在印刷攻击下定位白色背景上的水印图像，由于背景和图像之间有明显的边界，因此取得了令人满意的分割性能。
- Luo等人设计了一个模型来预测水印图像的缩放比例和偏移量，然而缺乏对其他几何攻击（例如，旋转，填充）的讨论。

此论文的方案
- 稀疏：因为是稀疏嵌入，从而对局部擦除攻击（local erasure attacks）更有鲁棒性。修改更小，更不易被察觉，对文件影响更小
- 随机：虽然在图像的固定位置嵌入水印信息使此论文更容易定位和提取，但它也增加了安全风险——被攻击者利用来擦除水印。为了避免这种情况，此论文随机选择每张图像的嵌入区域。 
- 一致。由于此论文的编码块分散在图像中，并且每个块中嵌入的消息是一致的，此论文可以通过充分利用所有提取结果之间的相似性来减少最终消息的偏差，从而确定一个更可靠的消息。

水印模型架构
- 也训练了端到端的水印模型来嵌入和提取水印。区别是水印的载体不是整个图像，而是图像块
- 为了限制编码块和封面块的差异，设计了两个指标，MSE控制像素级别修改，MSSSIM 控制不同尺度下的结构棉花

之后是效果实验数据