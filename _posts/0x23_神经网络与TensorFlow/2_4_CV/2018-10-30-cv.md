---
layout: post
title: ã€OpenCV1ã€‘è¯»å†™ã€ç©ºé—´å˜æ¢
categories:
tags: 0x25_CV
keywords:
description:
order: 1011
---


## æ€»æ½
```bash
pip install opencv-python
```

ç³»åˆ—æ–‡ç« 
1. io/è¿ç®—/è‰²å½©å˜æ¢/å‡ ä½•å˜æ¢
2. æ»¤æ³¢/å½¢æ€å­¦æ“ä½œ/å›¾åƒæ¢¯åº¦/è¾¹ç¼˜æ£€æµ‹/å›¾åƒé‡‘å­—å¡”/å›¾åƒè½®å»“
3. ç›´æ–¹å›¾/å‚…ç«‹å¶å˜æ¢/éœå¤«å˜æ¢
4. å›¾åƒåˆ†å‰²


è´¡çŒ®åº“æ˜¯ç¤¾åŒºå¼€å‘çš„ç®—æ³• `pip install opencv-contrib-python`ï¼Œ[æ–‡æ¡£](https://pypi.org/project/opencv-contrib-python/)
- bioinspired:ç”Ÿç‰©è§†è§‰æ¨¡å—ã€‚
-  datasets:æ•°æ®é›†è¯»å–æ¨¡å—ã€‚
-  dnn:æ·±åº¦ç¥ç»ç½‘ç»œæ¨¡å—ã€‚
-  face:äººè„¸è¯†åˆ«æ¨¡å—ã€‚
-  matlab:MATLAB æ¥å£æ¨¡å—ã€‚
-  stereo:åŒç›®ç«‹ä½“åŒ¹é…æ¨¡å—ã€‚
-  text:è§†è§‰æ–‡æœ¬åŒ¹é…æ¨¡å—ã€‚
-  tracking:åŸºäºè§†è§‰çš„ç›®æ ‡è·Ÿè¸ªæ¨¡å—ã€‚
-  ximgpro:å›¾åƒå¤„ç†æ‰©å±•æ¨¡å—ã€‚
-  xobjdetect:å¢å¼º 2D ç›®æ ‡æ£€æµ‹æ¨¡å—ã€‚
-  xphoto:è®¡ç®—æ‘„å½±æ‰©å±•æ¨¡å—ã€‚




## ç®€å•çš„æˆåƒæ¨¡å‹
$f(x,y)=i(x,y)r(x,y)$  
- x,y æ˜¯åæ ‡
- $i(x,y)$ å…¥å°„åˆ†é‡ï¼Œå–å†³äºå…‰æº
- $r(x,y)$ åå°„åˆ†é‡ï¼Œå–å†³æ— ç‰©ä½“çš„æè´¨

**æ•°å­—å›¾åƒè¡¨ç¤º** ç°å®ä¸­çš„åæ ‡ $x,y$ å’Œå€¼ $f(x,y)$ éƒ½æ˜¯è¿ç»­çš„ã€‚æ•°å­—å›¾åƒä¸­æ˜¯è¿ç»­çš„ï¼ˆå«åš **é‡‡æ ·**ï¼‰  

è¿™æ ·å°±äº§ç”Ÿäº†ä¸€ç³»åˆ—çš„æ¦‚å¿µã€‚
- é¥±å’Œåº¦ã€‚å®é™…å›¾åƒç°åº¦å€¼è¶…å‡ºé¥±å’Œåº¦ï¼Œè¢«å‰ªæˆæœ€é«˜å€¼ã€‚
- å™ªå£°ã€‚è¾ƒæš—çš„åŒºåŸŸã€‚
- åˆ†è¾¨ç‡
- ç°åº¦åˆ†è¾¨ç‡ã€‚ç°åº¦çº§å¯åˆ†è¾¨çš„æœ€å°å˜åŒ–ã€‚


## è¯»å†™å›¾åƒ


```python
import cv2

# è¯»
img = cv2.imread('img.jpg')
img = cv2.imread('img.jpeg', flags=cv2.IMREAD_UNCHANGED)


# æ˜¾
cv2.imshow(winname='title', mat=img)
cv2.waitKey(delay=0) # å•ä½æ˜¯æ¯«ç§’ï¼Œ0ä»£è¡¨æ— é™ç­‰å¾…ã€‚è‹¥åœ¨ç­‰å¾…æ—¶é—´å†…æŒ‰ä¸‹ä»»æ„é”®åˆ™è¿”å›æŒ‰é”®çš„ASCIIç ï¼Œç¨‹åºç»§ç»­è¿è¡Œã€‚è‹¥æ²¡æœ‰æŒ‰ä¸‹ä»»ä½•é”®ï¼Œè¶…æ—¶åè¿”å›-1
cv2.destroyAllWindows()
# cv2.destroyWindow('title') # ä¹Ÿå¯ä»¥


# å†™
cv2.imwrite('filename',img)
# å¯ä»¥æŒ‡å®šå›¾åƒè´¨é‡
cv2.imwrite(filename='img.jpg', img=img, params=[cv2.IMWRITE_JPEG_QUALITY, i]) # iæ˜¯0ï½100çš„æ•´æ•°ï¼Œè¡¨ç¤ºå›¾åƒè´¨é‡ï¼Œé»˜è®¤95

cv2.imwrite(filename='img.png', img=img, params=[cv2.IMWRITE_PNG_COMPRESSION, i]) # iæ˜¯0ï½9ï¼Œè¡¨ç¤ºå‹ç¼©çº§åˆ«ï¼Œé»˜è®¤3


# è¯»å…¥ä¸º bytes ç„¶åç”¨ opencv è¯»å…¥ bytes 
with open(filename, 'rb') as f:
    img_bytes = f.read()

image = cv2.imdecode(np.frombuffer(img_bytes, np.uint8), cv2.IMREAD_GRAYSCALE)
```


|flagå¯¹åº”çš„å€¼|å«ä¹‰|
|--|--|
cv2.IMREAD_COLOR |ï¼ˆé»˜è®¤ï¼‰BGR å›¾åƒ
cv2.IMREAD_UNCHANGED|è¯»å…¥å®Œæ•´å›¾ç‰‡ï¼ŒåŒ…æ‹¬alphaé€šé“
cv2.IMREAD_GRAYSCALE|å•é€šé“çš„ç°åº¦å›¾åƒ
cv2.IMREAD_ANYDEPTH|å½“è½½å…¥çš„å›¾åƒæ·±åº¦ä¸º 16 ä½æˆ–è€… 32 ä½æ—¶ï¼Œå°±è¿”å›å…¶å¯¹åº”çš„æ·±åº¦å›¾åƒ;å¦åˆ™ï¼Œå°†å…¶è½¬æ¢ä¸º 8 ä½å›¾åƒ
cv2.IMREAD_ANYCOLOR|ä»¥ä»»ä½•å¯èƒ½çš„é¢œè‰²æ ¼å¼è¯»å–å›¾åƒ


æ³¨æ„ï¼š
- é»˜è®¤è¯»è¿›æ¥çš„é€šé“é¡ºåºæ˜¯ BRG
- 0æ˜¯é¢œè‰²æœ€å°‘ï¼Œ255æ˜¯é¢œè‰²æœ€å¤šã€‚å¦‚æœ3ä¸ªé€šé“å…¨æ˜¯255ä»£è¡¨ç™½è‰²ï¼Œå…¨æ˜¯0ä»£è¡¨é»‘è‰²
- png å›¾ç‰‡è¿˜æœ‰ä¸€ä¸ª alpha é€šé“ï¼Œ255 è¡¨ç¤ºå®Œå…¨ä¸é€æ˜ï¼Œ0è¡¨ç¤ºå®Œå…¨é€æ˜
- æŒ‰ç…§åŠ æ³•ä¸‰åŸè‰²åšå åŠ ï¼Œå¦‚ä¸‹å›¾ï¼š

![ä¸‰åŸè‰²](/pictures_for_blog/blog/opencv/1.png)




## é¢œè‰²å˜æ¢


- GRAY(ç°åº¦å›¾åƒ)
    - 8 ä½ç°åº¦å›¾ï¼Œå…¶å…·æœ‰ 256 ä¸ªç°åº¦çº§ï¼Œåƒç´ å€¼çš„èŒƒå›´æ˜¯ `[0,255]`
    - RGB2GRAY å…¬å¼ `Gray = 0.299 Â· ğ‘… + 0.587 Â· ğº + 0.114 Â· ğµ`
    - GRAY2RGB å…¬å¼ `R = Gray; G = Gray; B = Gray`
- XYZ è‰²å½©ç©ºé—´
    - ç”± CIE(International Commission on Illumination)å®šä¹‰çš„ï¼Œæ˜¯ä¸€ç§æ›´ä¾¿äºè®¡ç®—çš„è‰²å½©ç©ºé—´ï¼Œå®ƒå¯ä»¥ä¸ RGB è‰²å½©ç©ºé—´ç›¸äº’è½¬æ¢ã€‚
    - è½¬æ¢æ˜¯ä¸€ä¸ª3x3çŸ©é˜µ
- YCrCb è‰²å½©ç©ºé—´
    - Y ä»£è¡¨äº®åº¦ï¼ŒCr è¡¨ç¤ºçº¢è‰²åˆ†é‡ï¼ŒCb è¡¨ç¤ºè“è‰²åˆ†é‡
    - JPEG å‹ç¼©éœ€è¦ç”¨åˆ°
    - RGB2YCrCbï¼ˆä¸åŒç³»ç»Ÿçš„å…¬å¼ä¸åŒï¼‰:
    - `Y = 0.299 * R + 0.587 * G + 0.114 * B`
    - `Cr = 0.5 * R - 0.418688 * G - 0.081312 * B + 128.0`
    - `Cb = -0.168736 * R - 0.331264 * G + 0.5 * B + 128.0`
- YUV ä¸ YCrCb ç±»ä¼¼ï¼Œä½† YUV ä¸»è¦ç”¨äºæ¨¡æ‹Ÿä¿¡å·
    - RGB2YUVï¼ˆä¸åŒç³»ç»Ÿçš„å…¬å¼ä¸åŒï¼‰:
    - `Y = 0.299 * R + 0.587 * G + 0.114 * B`
    - `U = -0.14713 * R - 0.28886 * G + 0.436 * B + 128.0`
    - `V = 0.615 * R - 0.51499 * G - 0.10001 * B + 128.0`
- HSV è‰²å½©ç©ºé—´
    - æ˜¯ä¸€ç§åŸºäºäººçœ¼è§†è§‰æ„ŸçŸ¥çš„è‰²å½©æ¨¡å‹
    - è‰²è°ƒ(Hueï¼Œä¹Ÿç§°ä¸ºè‰²ç›¸)å…‰çš„é¢œè‰²:è‰²è°ƒä¸æ··åˆå…‰è°±ä¸­çš„ä¸»è¦å…‰æ³¢é•¿ç›¸å…³ï¼Œä¾‹å¦‚â€œèµ¤æ©™é»„ç»¿é’è“ç´«â€åˆ†åˆ«è¡¨ç¤ºä¸åŒçš„ è‰²è°ƒã€‚å¦‚æœä»æ³¢é•¿çš„è§’åº¦è€ƒè™‘ï¼Œä¸åŒæ³¢é•¿çš„å…‰è¡¨ç°ä¸ºä¸åŒçš„é¢œè‰²ï¼Œå®é™…ä¸Šå®ƒä»¬ä½“ç°çš„æ˜¯è‰²è°ƒçš„å·®å¼‚ã€‚
    - è‰²è°ƒçš„å–å€¼åŒºé—´ä¸º[0, 360]ï¼Œå¯¹åº”é¢œè‰²è½¬ç›˜ä¸Šçš„å€¼
    - é¥±å’Œåº¦(Saturation)è‰²å½©çš„æ·±æµ…ç¨‹åº¦:æŒ‡ç›¸å¯¹çº¯å‡€åº¦ï¼Œæˆ–ä¸€ç§é¢œè‰²æ··åˆç™½å…‰çš„æ•°é‡ã€‚çº¯è°±è‰²æ˜¯å…¨é¥±å’Œçš„ï¼Œåƒæ·±çº¢è‰²(çº¢ åŠ ç™½)å’Œæ·¡ç´«è‰²(ç´«åŠ ç™½)è¿™æ ·çš„å½©è‰²æ˜¯æ¬ é¥±å’Œçš„ï¼Œé¥±å’Œåº¦ä¸æ‰€åŠ ç™½å…‰çš„æ•°é‡æˆåæ¯”ã€‚é¥±å’Œåº¦å–å€¼èŒƒå›´ [0, 1]ï¼Œå…·ä½“ä¸ºæ‰€é€‰é¢œè‰²çš„çº¯åº¦å€¼å’Œè¯¥é¢œè‰²æœ€å¤§çº¯åº¦å€¼ä¹‹é—´çš„æ¯”å€¼ã€‚é¥±å’Œåº¦çš„å€¼ä¸º 0 æ—¶ï¼Œåªæœ‰ç°åº¦ã€‚
    - äº®åº¦(Value)å–å€¼èŒƒå›´ä¹Ÿæ˜¯ [0, 1]ï¼Œäººçœ¼æ„Ÿå—åˆ°çš„å…‰çš„æ˜æš—ç¨‹åº¦:åæ˜ çš„æ˜¯äººçœ¼æ„Ÿå—åˆ°çš„å…‰çš„æ˜æš—ç¨‹åº¦ï¼Œè¯¥æŒ‡æ ‡ä¸ç‰©ä½“çš„åå°„åº¦æœ‰å…³ã€‚å¯¹äºè‰²å½©æ¥ è®²ï¼Œå¦‚æœåœ¨å…¶ä¸­æºå…¥çš„ç™½è‰²è¶Šå¤šï¼Œåˆ™å…¶äº®åº¦è¶Šé«˜;å¦‚æœåœ¨å…¶ä¸­æºå…¥çš„é»‘è‰²è¶Šå¤šï¼Œåˆ™å…¶äº® åº¦è¶Šä½ã€‚
- HLS è‰²å½©ç©ºé—´
    - åŒ…å«çš„ä¸‰è¦ç´ æ˜¯è‰²è°ƒ H(Hue)ã€å…‰äº®åº¦/æ˜åº¦ L(Lightness)ã€é¥±å’Œåº¦ S (Saturation)ã€‚
- CIEï¼ˆInternational Commission on Illuminationï¼‰ï¼šé¢å‘äººçœ¼æ„ŸçŸ¥çš„é¢œè‰²æ¨¡å‹
    - `CIEL*a*b*è‰²å½©ç©ºé—´`ï¼šå‡åŒ€è‰²å½©ç©ºé—´æ¨¡å‹ã€‚
        - `L*` ä»£è¡¨äº®åº¦ï¼Œ`a*` ä»£è¡¨ç»¿è‰²åˆ°çº¢è‰²åˆ†é‡,`b*`ä»£è¡¨è“è‰²åˆ°é»„è‰²åˆ†é‡
        - é€‚ç”¨äºå„ç§é¢œè‰²è½¬æ¢ã€è‰²å½©åŒ¹é…ä»»åŠ¡
        - é¢œè‰²ä¹‹é—´çš„è·ç¦»ï¼Œæ­¤æ¨¡å‹ä¸äººçœ¼æ„ŸçŸ¥ä¸€è‡´
    - `CIEL*u*v*`ï¼šå¦ä¸€ä¸ªä¸‰ä½é¢œè‰²ç©ºé—´
        - é€‚ç”¨äºç¯å…‰ã€è‰²å½©é…æ–¹ã€è‰²å½©è½¬æ¢ï¼Œå°¤å…¶å¤„ç†å…‰æºç›¸å…³çš„é¢œè‰²å˜åŒ–ï¼Œé€‚ç”¨äºéœ€è¦è€ƒè™‘äº®åº¦å¯¹é¢œè‰²è¡¥å¿ã€å„ç§å…‰ç…§æ¡ä»¶ä¸‹çš„é¢œè‰²æ„ŸçŸ¥ï¼Œé€‚ç”¨äºæ˜¾ç¤ºå™¨æ˜¾ç¤ºå’Œæ ¹æ®åŠ è‰²åŸç†è¿›è¡Œç»„åˆçš„åœºåˆï¼Œ
    - å¼ºè°ƒå¯¹çº¢è‰²çš„è¡¨ç¤ºï¼Œå³å¯¹çº¢è‰²çš„å˜åŒ–æ¯”è¾ƒæ•æ„Ÿï¼Œä½†å¯¹è“è‰²çš„å˜åŒ–ä¸å¤ªæ•æ„Ÿã€‚
- Bayer è‰²å½©ç©ºé—´(Bayer æ¨¡å‹)
    - å¹¿æ³›åœ°åº”ç”¨åœ¨ CCD å’Œ CMOS ç›¸æœºä¸­
- BGRA è‰²å½©ç©ºé—´
    - åœ¨ RGB è‰²å½©ç©ºé—´ä¸‰ä¸ªé€šé“çš„åŸºç¡€ä¸Šï¼Œè¿˜å¯ä»¥åŠ ä¸Šä¸€ä¸ª A é€šé“ï¼Œä¹Ÿå« alpha é€šé“ï¼Œè¡¨ç¤ºé€æ˜åº¦ã€‚
    - PNG å›¾åƒæ˜¯ä¸€ç§å…¸å‹çš„ 4 é€šé“å›¾åƒ
    - alpha é€šé“çš„èµ‹å€¼èŒƒå›´æ˜¯[0, 1]ï¼Œæˆ–è€…[0, 255]ï¼Œè¡¨ç¤ºä»é€æ˜åˆ°ä¸é€æ˜ã€‚
- CMYK(CMY)ç©ºé—´ï¼Œ
    - C:(Cyanï¼Œé’è‰²ï¼Œè“è‰²)ï¼ŒM(Magentaï¼Œå“çº¢ï¼Œçº¢)ï¼ŒYï¼ˆYellowï¼Œé»„è‰²ï¼‰ï¼ŒKï¼ˆKeyï¼‰é»‘è‰²
    - æ˜¯ä¸€ç§ç”¨äºå°åˆ·çš„é¢œè‰²æ¨¡å¼ã€‚æ˜¯ä¸€ç§å‡è‰²æ¨¡å‹ï¼ˆå¯¹æ¯”RGBæ˜¯åŠ è‰²æ¨¡å‹ï¼‰ï¼Œé¢œè‰²æ˜¯é€šè¿‡å¸æ”¶ï¼ˆå‡å»ï¼‰å…‰çº¤æ¥æ··åˆçš„ã€‚
    - Kï¼šé»‘è‰²ç”¨æ¥è°ƒæ•´é¢œè‰²æ·±åº¦å’Œå¯¹æ¯”åº¦ï¼Œä»¥èŠ‚çœå…¶å®ƒé¢œè‰²çš„æ²¹å¢¨
    - CMY æ¨¡å‹æ²¡æœ‰é»‘è‰²ï¼Œä¸å¤ªå¸¸ç”¨




```python
# ç°åº¦åŒ–ï¼Œå¹¶ä¸”å˜æˆå•é€šé“
img_gray = cv2.cvtColor(img, cv2.COLOR_BGR2GRAY)
# ç°åº¦è½¬RGBï¼ˆå®é™…ä»ç„¶æ˜¯ç°åº¦ï¼‰
img_rgb = cv2.cvtColor(img_grey, code=cv2.COLOR_GRAY2RGB)
# å¯ä»¥è½¬æ¥è½¬å»ï¼š
# cv2.COLOR_X2Yï¼Œå…¶ä¸­X,Y = RGB, BGR, GRAY, HSV, YCrCb, XYZ, Lab, Luv, HLS
# BGR
```


é€šé“æ‹†åˆ†å’Œåˆå¹¶
```py
b, g, r = cv2.split(img)
bgr = cv2.merge([b, g, r])
```

å›¾åƒé˜ˆå€¼è®¡ç®—
```py
img[img > 128] = 255
```



### äºŒå€¼åŒ–

```py
thresh_val, img2 = cv2.threshold(img, thresh=127, maxval=255, type=cv2.THRESH_BINARY)
# thresh_val æ˜¯åŸŸå€¼ï¼Œimg2 æ˜¯äºŒå€¼åŒ–åçš„å›¾
# å¯ä»¥è¾“å…¥å•é€šé“/3é€šé“ï¼Œå¯¹åº”è¿”å›å•é€šé“/3é€šé“
```

**è‡ªé€‚åº”é˜ˆå€¼ otsu**ï¼šå¯¹äºä¸€äº›æµ…è‰²æˆ–æ·±è‰²å›¾ï¼Œè®¾å®š127ä½œä¸ºé˜ˆå€¼æœªå¿…åˆé€‚ï¼ˆå¦‚ä¸‹å›¾ï¼‰ï¼Œå¯ä»¥ç”¨ ostu æ¥è®¡ç®—é˜ˆå€¼
```py
img = cv2.imread("a2.jpeg", 0)
t1, thd = cv2.threshold(img, 127, 255, cv2.THRESH_BINARY)
t, otsu = cv2.threshold(img, 0, 255, cv2.THRESH_BINARY + cv2.THRESH_OTSU)

cv2.imshow("img", img)
cv2.imshow("thd", thd)
cv2.imshow("otsu", otsu)
```

![ä¸‰å…ƒè‰²](/pictures_for_blog/blog/opencv/3.png)


å±€éƒ¨è‡ªé€‚åº”é˜ˆå€¼ï¼šå¯¹æ¯ä¸ªå±€éƒ¨åšé˜ˆå€¼å¤„ç†
```py
img = cv2.imread("a.jpeg", 0)
t1, thd = cv2.threshold(img, 127, 255, cv2.THRESH_BINARY)
athdMEAN = cv2.adaptiveThreshold(img
                                 , maxValue=255  # æœ€å¤§å€¼
                                 , adaptiveMethod=cv2.ADAPTIVE_THRESH_MEAN_C  # å±€éƒ¨å¹³å‡å€¼ä½œä¸ºé˜ˆå€¼
                                 , thresholdType=cv2.THRESH_BINARY  # é˜ˆå€¼å¤„ç†æ–¹å¼
                                 , blockSize=5  # å—å¤§å°ï¼Œé€šå¸¸æ˜¯3ï¼Œ5ï¼Œ7
                                 , C=3)
athdGAUS = cv2.adaptiveThreshold(img
                                 , maxValue=255
                                 , adaptiveMethod=cv2.ADAPTIVE_THRESH_GAUSSIAN_C  # å±€éƒ¨æŒ‰ç…§è·ç¦»çš„åŠ æƒä½œä¸ºé˜ˆå€¼
                                 , thresholdType=cv2.THRESH_BINARY
                                 , blockSize=5
                                 , C=3)
cv2.imshow("åŸå›¾", img)
cv2.imshow("äºŒå€¼åŒ–", thd)
cv2.imshow("è‡ªé€‚åº”äºŒå€¼åŒ–", athdMEAN)
cv2.imshow("é«˜æ–¯äºŒå€¼åŒ–", athdGAUS)
```

![ä¸‰åŸè‰²](/pictures_for_blog/blog/opencv/2.png)




## ç©ºé—´å˜æ¢

https://www.cnblogs.com/shizhengwen/p/8719062.html

### å¤§å°
å…³äºå¤§å°ï¼š
- `img.shape` åˆ†åˆ«æ˜¯è¡Œæ•°ã€åˆ—æ•°ã€é€šé“æ•°
- å¯¹æ¯”ï¼šæ“ä½œç³»ç»Ÿæ˜¾ç¤ºåˆ†è¾¨ç‡æ—¶ï¼Œç”¨çš„æ˜¯ (åˆ—æ•°ã€è¡Œæ•°)
- `img.dtype`å¾ˆå¤šæ˜¯ `uint8` ç±»å‹







### ç¼©æ”¾

å›¾åƒå†…æ’ï¼šä¸€ç§æ‰©å¤§åƒç´ çš„æ–¹æ³•ã€‚
- **è¿‘é‚»å†…æ’æ³•**ï¼šæŠŠå›¾åƒä¸­è¿‘é‚»çš„ç°åº¦èµ‹å€¼ç»™æ–°ä½ç½®  
- **åŒçº¿æ€§å†…æ’**ï¼šç”¨4ä¸ªæœ€è¿‘ä½ç½®å»ä¼°è®¡æ–°ä½ç½®çš„ç°åº¦ã€‚$v(x,y)=ax+by+cxy+d$ï¼Œå…¶ä¸­4ä¸ªç³»æ•°ç”±4ä¸ªè¿‘é‚»ç‚¹åˆ—å‡ºæ–¹ç¨‹è§£å‡ºæ¥ã€‚
- **åŒä¸‰æ¬¡å†…æ’**ï¼šç”¨16ä¸ªè¿‘é‚»ç‚¹ä¼°è®¡æ–°ä½ç½®ã€‚$v(x,y)=\sum\limits_{i=0}^3\sum\limits_{j=0}^3 a_{ij}x^iy^j$  ï¼ˆåŒä¸‰æ¬¡å†…æ’æ˜¯å•†ä¸šè½¯ä»¶çš„æ ‡å‡†å†…æ’æ–¹æ³•ï¼‰


```py
imag1=cv2.resize(imag,(100,100)) # æ”¹å˜åˆ†è¾¨ç‡åˆ° (100, 100)

cv2.resize(src=img, dsize=(0, 0), fx=0.5, fy=0.6,
                        interpolation=cv2.INTER_NEAREST)
# fx, fy å¯ä»¥æŒ‡å®šç¼©æ”¾æ¯”ä¾‹
# interpolation æŒ‡å®šå·®å€¼æ–¹æ³•ï¼š
# INTER_NEAREST, cv2.INTER_CUBIC


# åŠ ç™½è¾¹ï¼šæ¡ˆä¾‹æ˜¯ä¸Šä¸‹å„åŠ 50åƒç´ ç‚¹
cv2.copyMakeBorder(img, 50, 50, 0, 0,
                                       cv2.BORDER_CONSTANT,
                                       value=(0, 0, 0))
```


interpolation|è§£é‡Š|
|--|--|
cv2.INTER_LINEAR|åŒçº¿æ€§æ’å€¼(é»˜è®¤æ–¹å¼)
cv2.INTER_NEAREST|æœ€ä¸´è¿‘æ’å€¼ã€‚é€‰æ‹©ç›®æ ‡åƒç´ æœ€è¿‘çš„é‚£ä¸ªã€‚
cv2.INTER_CUBIC|ä¸‰æ¬¡æ ·æ¡æ’å€¼ï¼Œ4Ã—4 è¿‘é‚»åŒºåŸŸè¿›è¡Œä¸‰æ¬¡æ ·æ¡æ‹Ÿåˆ
cv2.INTER_AREA|åŒºåŸŸæ’å€¼ï¼Œç±»ä¼¼æœ€ä¸´è¿‘æ’å€¼æ–¹å¼
cv2.INTER_LANCZOS4|8Ã—8 è¿‘é‚»çš„ Lanczos æ’å€¼æ–¹æ³•
cv2.INTER_LINEAR_EXACT|ä½ç²¾ç¡®åŒçº¿æ€§æ’å€¼
cv2.INTER_MAX|å·®å€¼ç¼–ç æ©ç 
cv2.WARP_FILL_OUTLIERS|

### ç¿»è½¬
```python
img_flip = cv2.flip(img, flipCode=0)
# flipCode>0 å·¦å³ç¿»è½¬
# flipCode=0 ä¸Šä¸‹ç¿»è½¬
# flipCode<0 ä¸Šä¸‹å·¦å³åŒæ—¶ç¿»è½¬
```


### åæ ‡çš„ç©ºé—´å˜æ¢ç†è®ºç¯‡

åæ ‡å˜æ¢çš„ä¸€èˆ¬å½¢å¼ï¼š$(x,y)=T((v,w))$ï¼ŒæŠŠåŸå›¾ä¸­æŸä¸ªåæ ‡ $(v,w)$ æ˜ å°„åˆ°æ–°åæ ‡ $(x,y)$  
ä¾‹å¦‚ï¼Œ$(x,y)=T((v,w))=(v/2,w/2)$ï¼Œè¿™æ˜¯ä¸€ä¸ªæŠŠå›¾åƒåœ¨ä¸¤ä¸ªæ–¹å‘ä¸Šç¼©å°ä¸€åŠçš„å˜æ¢ã€‚  

æœ€å¸¸ç”¨çš„ç©ºé—´åæ ‡å˜æ¢ï¼š**ä»¿å°„å˜æ¢**:  


$$
\left [\begin{array}{ccc} x\\y\\1 \end{array}\right]
= M \left [\begin{array}{ccc} u\\w\\1 \end{array}\right]
= \left [\begin{array}{ccc}
a_{00}&a_{01}&b_0\\
a_{10}&a_{11}&b_1\\
0&0&1\\
\end{array}\right]
\left [\begin{array}{ccc} u\\w\\1 \end{array}\right]
$$



ä¸¾ä¾‹æ¥è¯´ï¼š
1. å°ºåº¦å˜æ¢ $$\left [\begin{array}{ccc} c_1&0&0\\ 0&c_2&0\\0&0&1\\ \end{array}\right]$$
2. æ—‹è½¬å˜æ¢ $$\left [\begin{array}{ccc} \cos \theta &\sin \theta &0\\ -\sin \theta &\cos\theta&0\\ 0&0&1\\ \end{array}\right]$$
3. å¹³ç§»å˜æ¢ $$\left [\begin{array}{ccc} 1 &0&t_x\\ 0 &1&t_y\\ 0&0&1\\ \end{array}\right]$$
4. å‚ç›´åç§»å˜æ¢ $$\left [\begin{array}{ccc} 1&s_v&0\\ 0&1&0\\ 0&0&1\\ \end{array}\right]$$
5. æ°´å¹³åç§»å˜æ¢ $$\left [\begin{array}{ccc} 1 &0&0\\ s_h&1&0\\ 0&0&1\\ \end{array}\right]$$


åœ¨ä»£ç ä¸­ï¼ŒMçŸ©é˜µçœç•¥æœ€åä¸€è¡Œ

```Python
# æ²¿ç€åæ ‡è½´æ”¾å¤§ï¼Œå¹¶å¹³ç§»
M = np.array([[1.6, 0, -150],
              [0, 1.6, -240]])
img_aff = cv2.warpAffine(src=img, M=M, dsize=img.shape[1::-1])


# é¡ºæ—¶é’ˆæ—‹è½¬15åº¦
theta = 15 * np.pi / 180
M = np.array([
    [np.cos(theta), -np.sin(theta), 0],
    [np.sin(theta), np.cos(theta), 0]
], dtype=np.float32)
img_aff = cv2.warpAffine(src=img, M=M, dsize=img.shape[1::-1])

# cv2 æä¾›äº†ä¸€ä¸ªå‡½æ•°ï¼šæ ¹æ®æ—‹è½¬ä¸­å¿ƒå’Œæ—‹è½¬è§’ï¼Œè®¡ç®—å¯¹åº”çš„çŸ©é˜µ
M = cv2.getRotationMatrix2D(center=(cols / 2, rows / 2), angle=2, scale=1)
# centeræ˜¯æ—‹è½¬çš„ä¸­å¿ƒï¼Œangleæ˜¯æ—‹è½¬è§’ï¼Œscaleæ˜¯ç¼©æ”¾å¤§å°
```

`cv2.warpAffine( src, M, dsize[, flags[, borderMode[, borderValue]]] )`
- dsize ä»£è¡¨è¾“å‡ºå›¾åƒçš„å°ºå¯¸å¤§å°ã€‚å¤šä½™éƒ¨åˆ†è£å‰ªï¼Œå°‘çš„éƒ¨åˆ†å¡«å……ã€‚è®¡ç®—å¤§å°æ—¶ï¼Œå·¦ä¸Šè§’ä¸ºèµ·ç‚¹ã€‚
- flags ä»£è¡¨æ’å€¼æ–¹æ³•ï¼Œé»˜è®¤ä¸º INTER_LINEARã€‚
- borderMode ä»£è¡¨è¾¹ç±»å‹ï¼Œé»˜è®¤ä¸º BORDER_CONSTANTã€‚å½“è¯¥å€¼ä¸º BORDER_ TRANSPARENT æ—¶ï¼Œæ„å‘³ç€ç›®æ ‡å›¾åƒå†…çš„å€¼ä¸åšæ”¹å˜ï¼Œè¿™äº›å€¼å¯¹åº”åŸå§‹å›¾åƒå†…çš„å¼‚å¸¸å€¼ã€‚
- borderValue é»˜è®¤å¡«å……æ–¹å¼ï¼ŒBGRï¼Œé»˜è®¤æ˜¯ `(0,0,0)`ã€‚





### é€è§†

ç»™å®š4ä¸ªé¡¶ç‚¹å¯¹åº”çš„ä½ç½®ï¼Œå¾—åˆ°æ•´ä¸ªå›¾ç‰‡çš„æ˜ å°„

```py
h, w = img.shape[:2]

A = cv2.getPerspectiveTransform(
    src=np.array([[0, 0], [w, 0], [0, h], [w, h]], np.float32),
    dst=np.array([[w / 2, 0], [w, 0], [0, h], [w, h / 2.0]], np.float32))

img2 = cv2.warpPerspective(img, A, (w, h))
```
ç‚¹çš„é¡ºåºåˆ†åˆ«æ˜¯å·¦ä¸Šã€å³ä¸Šã€å·¦ä¸‹ã€å³ä¸‹

### åƒç´ æ˜ å°„

`cv2.remap( src, map1, map2, interpolation[, borderMode[, borderValue]] )`
- åŠŸèƒ½ï¼šå¯ä»¥æŒ‡å®šæ¯ä¸ªåƒç´ æ˜ å°„åˆ°æ–°å›¾çš„å“ªä¸ªä½ç½®
- map1ï¼Œmap2ï¼Œå…¶å®å¯ä»¥ç†è§£ä¸º mapxï¼Œmapyï¼Œè¾“å‡ºçš„shapeå’Œä»–ä»¬ä¸€æ ·ï¼Œè¡¨ç¤ºæ–°å›¾æ¯ä¸ªä½ç½®çš„åƒç´ ï¼Œåœ¨æ—§å›¾çš„å“ªä¸ªä½ç½®ã€‚å¯ä»¥ä¸ºå°æ•°
- Interpolation æ’å€¼æ–¹æ³•ï¼Œå–å€¼åŒä¸Š
- borderMode è¾¹ç•Œæ¨¡å¼ï¼ŒborderValue è¾¹ç•Œå€¼

ä¸¾ä¾‹ç†è§£ï¼š
```py
img=
[[120 183 101 252 219]
 [ 51 106 168 221 118]
 [147 16 3 14 159]
 [219 67 254 16 62]]

mapx=
 [[3. 3. 3. 3. 3.]
 [3. 3. 3. 3. 3.]
 [3. 3. 3. 3. 3.]
 [3. 3. 3. 3. 3.]]

mapy=
 [[0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]

# ç»“æœï¼šï¼ˆå°±æ˜¯æ–°å›¾æ‰€æœ‰ç‚¹éƒ½æ˜¯ï¼šæ—§å›¾ä¸­ç¬¬0è¡Œç¬¬3åˆ—çš„å…ƒç´ ï¼‰
 rst=
      [[252 252 252 252 252]
      [252 252 252 252 252]
      [252 252 252 252 252]
      [252 252 252 252 252]]
```

è¿›é˜¶ç”¨æ³•ï¼šé€šè¿‡æ”¹å˜ mapxï¼Œmapyï¼Œå¯ä»¥åšåˆ°
1. å›¾åƒç¼©æ”¾
2. å›¾åƒç¿»è½¬


ä¸‹é¢æ˜¯ç”¨remapåšå›¾åƒç¿»è½¬+æ”¹å˜åˆ†è¾¨ç‡+ç¼©æ”¾

```py
length, height = 800, 800
map_x, map_y = np.zeros((800, 800), dtype=np.float32), np.zeros((800, 800), dtype=np.float32)
for i in range(length):
    for j in range(height):
        map_x[j, i] = j / length * img.shape[1] * 1.5
        map_y[j, i] = i / height * img.shape[0] * 1.2

img2 = cv2.remap(img, map1=map_x, map2=map_y, interpolation=cv2.INTER_LINEAR)
```



## æ·»åŠ æ–‡å­—å’Œå›¾

æ·»åŠ æ–‡å­—
```python
# å…¥å‚åˆ†åˆ«æ˜¯å›¾ç‰‡ã€æ–‡æœ¬ã€åƒç´ ã€å­—ä½“ã€å­—ä½“å¤§å°ã€é¢œè‰²ã€å­—ä½“ç²—ç»†
imgzi = cv2.putText(img=img, text="guofei", org=(500, 500),
                    fontFace=font, fontScale=2.5, color=(0, 0, 0), thickness=2)
```

æ·»åŠ é›†åˆå›¾åƒ
```python
import numpy as np
import cv2

np.set_printoptions(threshold='nan')
# åˆ›å»ºä¸€ä¸ªå®½512é«˜512çš„é»‘è‰²ç”»å¸ƒï¼ŒRGB(0,0,0)å³é»‘è‰²
img=np.zeros((512,512,3),np.uint8)


# ç”»ç›´çº¿,å›¾ç‰‡å¯¹è±¡ï¼Œèµ·å§‹åæ ‡(xè½´,yè½´)ï¼Œç»“æŸåæ ‡ï¼Œé¢œè‰²ï¼Œå®½åº¦
cv2.line(img,(0,0),(311,511),(255,0,0),10)
# ç”»çŸ©å½¢ï¼Œå›¾ç‰‡å¯¹è±¡ï¼Œå·¦ä¸Šè§’åæ ‡ï¼Œå³ä¸‹è§’åæ ‡ï¼Œé¢œè‰²ï¼Œå®½åº¦
cv2.rectangle(img,(30,166),(130,266),(0,255,0),3)
# ç”»åœ†å½¢ï¼Œå›¾ç‰‡å¯¹è±¡ï¼Œä¸­å¿ƒç‚¹åæ ‡ï¼ŒåŠå¾„å¤§å°ï¼Œé¢œè‰²ï¼Œå®½åº¦
cv2.circle(img,(222,222),50,(255.111,111),-1)
# ç”»æ¤­åœ†å½¢ï¼Œå›¾ç‰‡å¯¹è±¡ï¼Œä¸­å¿ƒç‚¹åæ ‡ï¼Œé•¿çŸ­è½´ï¼Œé¡ºæ—¶é’ˆæ—‹è½¬åº¦æ•°ï¼Œå¼€å§‹è§’åº¦(å³é•¿è½´è¡¨0åº¦ï¼Œä¸ŠçŸ­è½´è¡¨270åº¦)ï¼Œé¢œè‰²ï¼Œå®½åº¦
cv2.ellipse(img,(333,333),(50,20),0,0,150,(255,222,222),-1)

# ç”»å¤šè¾¹å½¢ï¼ŒæŒ‡å®šå„ä¸ªç‚¹åæ ‡,arrayå¿…é¡»æ˜¯int32ç±»å‹
pts=np.array([[10,5],[20,30],[70,20],[50,10]], np.int32)
# -1è¡¨ç¤ºè¯¥çº¬åº¦é åé¢çš„çº¬åº¦è‡ªåŠ¨è®¡ç®—å‡ºæ¥ï¼Œå®é™…ä¸Šæ˜¯4

pts = pts.reshape((-1,1,2,))
# print(pts)
# ç”»å¤šæ¡çº¿ï¼ŒFalseè¡¨ä¸é—­åˆï¼ŒTrueè¡¨ç¤ºé—­åˆï¼Œé—­åˆå³å¤šè¾¹å½¢
cv2.polylines(img,[pts],True,(255,255,0),5)

#å†™å­—,å­—ä½“é€‰æ‹©
font=cv2.FONT_HERSHEY_SCRIPT_COMPLEX

# å›¾ç‰‡å¯¹è±¡ï¼Œè¦å†™çš„å†…å®¹ï¼Œå·¦è¾¹è·ï¼Œå­—çš„åº•éƒ¨åˆ°ç”»å¸ƒä¸Šç«¯çš„è·ç¦»ï¼Œå­—ä½“ï¼Œå¤§å°ï¼Œé¢œè‰²ï¼Œç²—ç»†
cv2.putText(img,"OpenCV",(10,400),font,3.5,(255,255,255),2)

a=cv2.imwrite("picture.jpg",img)
cv2.imshow("picture",img)
cv2.waitKey(0)

cv2.destroyAllWindows()
```
è¿˜æœ‰(ä¸Šä¸‹è¿™ä¸¤éƒ¨åˆ†ä»£ç éƒ½æ²¡æ•´ç†)
```python
import numpy as np
import cv2

# å®šä¹‰ä¸€å—å®½600ï¼Œé«˜400çš„ç”»å¸ƒï¼Œåˆå§‹åŒ–ä¸ºç™½è‰²
canvas = np.zeros((400, 600, 3), dtype=np.uint8) + 255

# ç”»ä¸€æ¡çºµå‘çš„æ­£ä¸­å¤®çš„é»‘è‰²åˆ†ç•Œçº¿
cv2.line(canvas, (300, 0), (300, 399), (0, 0, 0), 2)

# ç”»ä¸€æ¡å³åŠéƒ¨ä»½ç”»é¢ä»¥150ä¸ºç•Œçš„æ¨ªå‘åˆ†ç•Œçº¿
cv2.line(canvas, (300, 149), (599, 149), (0, 0, 0), 2)

# å·¦åŠéƒ¨åˆ†çš„å³ä¸‹è§’ç”»ä¸ªçº¢è‰²çš„åœ†
cv2.circle(canvas, (200, 300), 75, (0, 0, 255), 5)

# å·¦åŠéƒ¨åˆ†çš„å·¦ä¸‹è§’ç”»ä¸ªè“è‰²çš„çŸ©å½¢
cv2.rectangle(canvas, (20, 240), (100, 360), (255, 0, 0), thickness=3)

# å®šä¹‰ä¸¤ä¸ªä¸‰è§’å½¢ï¼Œå¹¶æ‰§è¡Œå†…éƒ¨ç»¿è‰²å¡«å……
triangles = np.array([
    [(200, 240), (145, 333), (255, 333)],
    [(60, 180), (20, 237), (100, 237)]])
cv2.fillPoly(canvas, triangles, (0, 255, 0))

# ç”»ä¸€ä¸ªé»„è‰²äº”è§’æ˜Ÿ
# ç¬¬ä¸€æ­¥é€šè¿‡æ—‹è½¬è§’åº¦çš„åŠæ³•æ±‚å‡ºäº”ä¸ªé¡¶ç‚¹
phi = 4 * np.pi / 5
rotations = [[[np.cos(i * phi), -np.sin(i * phi)], [i * np.sin(phi), np.cos(i * phi)]] for i in range(1, 5)]
pentagram = np.array([[[[0, -1]] + [np.dot(m, (0, -1)) for m in rotations]]], dtype=np.float)

# å®šä¹‰ç¼©æ”¾å€æ•°å’Œå¹³ç§»å‘é‡æŠŠäº”è§’æ˜Ÿç”»åœ¨å·¦åŠéƒ¨åˆ†ç”»é¢çš„ä¸Šæ–¹
pentagram = np.round(pentagram * 80 + np.array([160, 120])).astype(np.int)

# å°†5ä¸ªé¡¶ç‚¹ä½œä¸ºå¤šè¾¹å½¢é¡¶ç‚¹è¿çº¿ï¼Œå¾—åˆ°äº”è§’æ˜Ÿ
cv2.polylines(canvas, pentagram, True, (0, 255, 255), 9)

# æŒ‰åƒç´ ä¸ºé—´éš”ä»å·¦è‡³å³åœ¨ç”»é¢å³åŠéƒ¨ä»½çš„ä¸Šæ–¹ç”»å‡ºHSVç©ºé—´çš„è‰²è°ƒè¿ç»­å˜åŒ–
for x in range(302, 600):
    color_pixel = np.array([[[round(180*float(x-302)/298), 255, 255]]], dtype=np.uint8)
    line_color = [int(c) for c in cv2.cvtColor(color_pixel, cv2.COLOR_HSV2BGR)[0][0]]
    cv2.line(canvas, (x, 0), (x, 147), line_color)

# å¦‚æœå®šä¹‰åœ†çš„çº¿å®½å¤§äºåŠæ–¤ï¼Œåˆ™ç­‰æ•ˆäºç”»åœ†ç‚¹ï¼Œéšæœºåœ¨ç”»é¢å³ä¸‹è§’çš„æ¡†å†…ç”Ÿæˆåæ ‡
np.random.seed(42)
n_pts = 30
pts_x = np.random.randint(310, 590, n_pts)
pts_y = np.random.randint(160, 390, n_pts)
pts = zip(pts_x, pts_y)

# ç”»å‡ºæ¯ä¸ªç‚¹ï¼Œé¢œè‰²éšæœº
for pt in pts:
    pt_color = [int(c) for c in np.random.randint(0, 255, 3)]
    cv2.circle(canvas, pt, 3, pt_color, 5)

# åœ¨å·¦åŠéƒ¨åˆ†æœ€ä¸Šæ–¹æ‰“å°æ–‡å­—
cv2.putText(canvas,
            'Python-OpenCV Drawing Example',
            (5, 15),
            cv2.FONT_HERSHEY_SIMPLEX,
            0.5,
            (0, 0, 0),
            1)

cv2.imshow('Example of basic drawing functions', canvas)
cv2.waitKey()
```


## æ‰“å¼€æ‘„åƒå¤´

```py
import cv2

capture = cv2.VideoCapture(0)
print(capture.get(0))
while(True):
    # è·å–ä¸€å¸§
    ret, frame = capture.read()
    # ret æ˜¯å¸ƒå°”å€¼ï¼Œè¡¨ç¤ºå½“å‰å¸§æ˜¯å¦æ­£ç¡®ï¼›frameæ˜¯np.array

    # è½¬æ¢ä¸ºç°åº¦å›¾
    gray = cv2.cvtColor(frame, cv2.COLOR_BGR2GRAY)

    # æ˜¾ç¤º
    cv2.imshow('frame', gray) # å¦‚æœæ˜¯ int8 ç±»å‹ï¼Œå°±æ˜¯0~256ï¼Œå¦‚æœæ˜¯floatï¼Œå°±æ˜¯0~1
    if cv2.waitKey(1) == ord('q'):
        break

cv2.destroyAllWindows()
capture.release()
```

è·å–å±æ€§
```py
capture.get(propId) # å¯ä»¥è·å–æ‘„åƒå¤´çš„ä¸€äº›å±æ€§
capture.set(propId,value)

width, height = capture.get(3), capture.get(4)
```

## å½•è§†é¢‘
```py
capture = cv2.VideoCapture(0)

# å®šä¹‰ç¼–ç æ–¹å¼å¹¶åˆ›å»ºVideoWriterå¯¹è±¡
fourcc = cv2.VideoWriter_fourcc(*'MJPG')
outfile = cv2.VideoWriter('output.avi', fourcc, 25., (640, 480))

while(capture.isOpened()):
    ret, frame = capture.read()

    if ret:
        outfile.write(frame)  # å†™å…¥æ–‡ä»¶
        cv2.imshow('frame', frame)
        if cv2.waitKey(1) == ord('q'):
            break
    else:
        break
```

## æ’­æ”¾æœ¬åœ°è§†é¢‘
```py
capture = cv2.VideoCapture('demo_video.mp4')

while(capture.isOpened()):
    ret, frame = capture.read()
    gray = cv2.cvtColor(frame, cv2.COLOR_BGR2GRAY)

    cv2.imshow('frame', gray)
    if cv2.waitKey(30) == ord('q'):
        break
```



## matplotlib ç›¸å…³
```py
img = plt.imread('image.jpg') # è¿”å›ä¸€ä¸ªm*n*3 çš„ np.array å¯¹è±¡
# å›¾åƒæ•°ç»„å¯ä»¥æ˜¯ä»¥ä¸‹ç±»å‹
# M*N      æ­¤æ—¶æ•°ç»„å¿…é¡»ä¸ºæµ®ç‚¹å‹ï¼Œå…¶ä¸­å€¼ä¸ºè¯¥åæ ‡çš„ç°åº¦ï¼›
# M*N*3  RGBï¼ˆæµ®ç‚¹å‹æˆ–è€…unit8ç±»å‹ï¼‰
# M*N*4  RGBAï¼ˆæµ®ç‚¹å‹æˆ–è€…unit8ç±»å‹ï¼‰
# å¯¹æ¯”ï¼Œç”¨cv2è¯»å–çš„æ˜¯BGR

# æ˜¾ç¤ºå›¾åƒ
plt.imshow(img)
plt.show()
```



## PIL.Image

è¯»å†™
```python

from PIL import Image

# è¯»
img = Image.open(fp='img.png')
# å­˜
img.save('img_new.png')

# æ˜¾
img.show()

# çœ‹æ ¼å¼
img.mode  # 'RGBA'

img.convert("RGB")
# '1': æŠŠå›¾åƒè½¬ä¸ºäºŒå€¼å›¾
# 'L'ï¼šå°†å›¾åƒè½¬æ¢ä¸ºç°åº¦å›¾åƒã€‚
# 'RGB'ï¼šå°†å›¾åƒè½¬æ¢ä¸º RGB å½©è‰²å›¾åƒã€‚
# 'RGBA'ï¼šå°†å›¾åƒè½¬æ¢ä¸ºå¸¦æœ‰é€æ˜é€šé“çš„ RGBA å›¾åƒã€‚
# 'CMYK'ï¼šå°†å›¾åƒè½¬æ¢ä¸º CMYK é¢œè‰²æ¨¡å¼ã€‚
# 'HSV'ï¼šå°†å›¾åƒè½¬æ¢ä¸º HSV é¢œè‰²æ¨¡å¼ã€‚
# 'YCbCr'ï¼šå°†å›¾åƒè½¬æ¢ä¸º YCbCr é¢œè‰²æ¨¡å¼ã€‚


img.size # å›¾åƒå¤§å°
img.info # å›¾åƒä¿¡æ¯



# ???img.load()

img.getpixel(xy=(6, 10)) # è¿”å›æŒ‡å®šä½ç½®çš„åƒç´ å€¼
img.putpixel(xy=(6, 10), value=(5,6,255)) # è®¾å®šåƒç´ å€¼
img.getchannel(0)  # æŸä¸€ä¸ªé€šé“ä½œä¸ºå•ç‹¬çš„å›¾ç‰‡è¿”å›


img.tobytes()  # è¿”å›äºŒè¿›åˆ¶å½¢å¼
img.frombytes(my_bytes) # äºŒè¿›åˆ¶è½¬å›¾ç‰‡

np.array(img) # è½¬ ndarray
```

è¯»å– base64 æ ¼å¼çš„å›¾ç‰‡
```python
import base64
from PIL import Image
import io
import cv2
import numpy as np

# base64 æ ¼å¼çš„å›¾ç‰‡
with open('æµ‹è¯•å›¾ç‰‡.png', 'rb') as f:
    s_b64 = base64.b64encode(f.read()).decode('utf-8')

# è½¬å›ä¸º bytes ç±»å‹
image_data = base64.b64decode(s_b64)

# PIL.Image éœ€è¦å€ŸåŠ© io.BytesIO æ¥è¯»å–
image = Image.open(io.BytesIO(image_data))

# opencv éœ€è¦å€ŸåŠ© np.frombuffer æ¥è¯»å–
image = cv2.imdecode(
    np.frombuffer(image_data, np.uint8)
    , cv2.IMREAD_COLOR
)
```


ImageChopsï¼šå¤åˆ¶å’Œæ¯”è¾ƒ
```Python
from PIL import ImageChops

# å¤åˆ¶ä¸€ä»½
img1 = ImageChops.duplicate(image=img)

# æ¯”è¾ƒä¸¤ä¸ªå›¾ç‰‡çš„å·®
img_diff = ImageChops.difference(img, img1)  # ä¹Ÿæ˜¯ <Image> ç±»å‹ï¼Œå¯ä»¥ img_diff.show()
```

ImageEnhanceï¼šè°ƒæ•´äº®åº¦ã€å¯¹æ¯”åº¦ç­‰

```python
from PIL import ImageEnhance

enhancer = ImageEnhance.Brightness(image=img)
img1 = enhancer.enhance(factor=0.5)  # äº®åº¦å‡åŠ

img1.show()

enhancer = ImageEnhance.Color(image=img)  # é¢œè‰²å¢å¼º
ImageEnhance.Contrast(image=img)
ImageEnhance.Sharpness(image=img)
```
